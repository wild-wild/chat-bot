const { createBot, createProvider, createFlow, addKeyword, toSerialize, addAnswer } = require('@bot-whatsapp/bot')

const QRPortalWeb = require('@bot-whatsapp/portal') //portal web para escanear el qr
const BaileysProvider = require('@bot-whatsapp/provider/baileys')//proveedor de whatsapp
const MockAdapter = require('@bot-whatsapp/database/mock') //base de datos
const { mediaMessageSHA256B64 } = require('@adiwajshing/baileys')
/***************************************************************************/
//RESPUESTAS A PREGUNTAS FRECUENTES Y TRAMITES
/***************************************************************************/
const flowFAQ1 = addKeyword('1')
.addAnswer([
    'En el Siguiente link Acceda con su n√∫mero de registro universitario y como contrase√±a su n√∫mero de C√©dula de Identidad.',
    'https://perfil.uagrm.edu.bo/',
])
const flowFAQ2 = addKeyword('2')
.addAnswer([
    'Use del m√©todo de recuperaci√≥n de contrase√±a por correo electr√≥nico, opci√≥n habilitada en el ingreso al perfil.',
])
const flowFAQ3 = addKeyword('3')
.addAnswer([
    'Contacte con el encargado del CPD FACULTATIVO de la facultad a la que pertenece la carrera que cursa y solicite el registro de su correo electr√≥nico.',
    'Los estudiantes de la Unidad a Distancia en CPD de la facultad de Humanidades.',
])
const flowFAQ4 = addKeyword('4')
.addAnswer([
    'Contacte con el encargado del CPD FACULTATIVO de la facultad a la que pertenece la carrera que cursa y solicite la actualizaci√≥n de su correo electr√≥nico.',
    'Los estudiantes de la Unidad a Distancia en CPD de la facultad de Humanidades.',
])
const flowFAQ5 = addKeyword('5')
.addAnswer([
    'Las entidades autorizadas son: ',
])
const flowFAQ6 = addKeyword('6')
.addAnswer([
    'Tiene que dirigirse al CPD FACULTATIVO de la facultad a la que pertenece.',
    'Los estudiantes de la Unidad a Distancia en CPD de la facultad de Humanidades.',
])
const flowFAQ7 = addKeyword('7')
.addAnswer([
    'Revise si est√° Bloqueado por alg√∫n concepto, para ello debe autentificarse haciendo clic en Login, luego seleccione la Carrera y entre a la opci√≥n Otros Servicios/Bloqueos. Para hacer el desbloqueo siga las instrucciones para cada caso.',
])
const flowFAQ8 = addKeyword('8')
.addAnswer([
    'En Secretaria del Departamento de Admisiones y Registros presentar los siguientes documentos:\n',
    '1-Fotocopia de Certificado de Nacimiento',
    '2-Fotocopia de Carnet de Identidad (sin legalizar)',
    '3-Fotocopia del T√≠tulo de Bachiller',
    '4-Formulario de correcci√≥n de Nombre debidamente llenado (Adquirir en cualquier fotocopiadora en inmediaciones del Campus Universitario)\n',
    '_Nota: En casos de cambio, aumento o retiro de nombre o apellido adjunte fotocopia de la sentencia judicial dictada por el Juez ordenando proceder cambio nombre._',
])
//respuesta a Contactar con una persona
const flowContacto = addKeyword(['Contactar con una persona üôç‚Äç‚ôÇÔ∏è','Chatear con una persona üôç‚Äç‚ôÇÔ∏è']).addAnswer([
    'Enseguida le atender√° un *Administrador* de la *Unidad a Distancia de la Facultad de Humanidades.*',
],
    {
        delay: 3000,
    })
    .addAnswer(
        'Por favor ind√≠quemos ¬øEn que podemos ayudarte?',
        {
            delay: 3000,
        }
    )

// VOLVER
const flowVolver = addKeyword(['‚Ü© volver al menu principal','0'])
    .addAnswer('*Hola*,ü§ñ soy el Asistente Virtual de la *Unidad a Distancia de la Facultad de Humanidades*, tengo varias opciones para ayudarte',
    )
    .addAnswer('La modalidad a *Distancia* consiste en un *Sistema H√≠brido*, es decir, rige su avance por tutor√≠as presenciales y virtuales programadas en d√≠as domingo.',
        'Si un estudiante est√° ubicado en otro departamento y no puede asistir a las tutor√≠as presencial, debe presentar una constancia de residencia para acceder a las opciones virtuales. Esto significa que el estudiante puede continuar su educaci√≥n virtual y recibir la misma calidad de educaci√≥n que los estudiantes que asisten a las tutor√≠as presenciales.',
        {
            delay: 3000,
        })
    .addAnswer('_Elige una de las siguientes opciones: üëá_',
        {
            buttons: [
                { "body": "Carreras ofertas", },
                { "body": "Nuestra ubicaci√≥n üìç" },
                { "body": "Preguntas frecuentes FAQ" },
            ],
            delay: 1000,
        },
    )
    .addAnswer('_Cualquier duda que tengas, Presionaüëá_',
        {
            buttons: [
                { "body": "Contactar con una persona üôç‚Äç‚ôÇÔ∏è" },
            ],
            delay: 1000,
        })


//ADM si o no 
const flowSiAdm = addKeyword(['si', 'Si', 'SI'])
    .addAnswer('Muy bien, Estas son las *Asignaturas* que se imparten actualmente en la carrera de Administraci√≥n Educativa',
        {
            media: 'https://i.ibb.co/zJjpqGH/adm-pensul.jpg',
        },
        {
            delay: 3000,
        }
    )
    .addAnswer('üëá',
        {
            buttons: [
                { 'body': "Chatear con una persona üôç‚Äç‚ôÇÔ∏è" },
                { body: '‚Ü© volver al menu principal' }],
        },
    )
//COM si o no 
const flowSiEdu = addKeyword(['si', 'Si', 'SI'])
    .addAnswer('Muy bien, Estas son las *Asignaturas* que se imparten actualmente en la carrera de Ciencias de la Educaci√≥n',
        {
            media: 'https://i.ibb.co/grY3jdP/EDU-PENSUL.jpg',
        },
        {
            delay: 3000,
        })
        .addAnswer('üëá',
        {
            buttons: [
                { 'body': "Chatear con una persona üôç‚Äç‚ôÇÔ∏è" },
                { body: '‚Ü© volver al menu principal' }],
        },
    )
//COM si o no 
const flowSiCom = addKeyword(['si', 'Si', 'SI'])
    .addAnswer('Muy bien, Estas son las *Asignaturas* que se imparten actualmente en la carrera de Ciencias de la Comunicaci√≥n',
        {
            media: 'https://i.ibb.co/7ttGJGV/COM-PENSUL.jpg',
        },
        {
            delay: 3000,
        })
        .addAnswer('üëá',
        {
            buttons: [
                { 'body': "Chatear con una persona üôç‚Äç‚ôÇÔ∏è" },
                { body: '‚Ü© volver al menu principal' }],
        },
    )


//SI ESCOGE CIENCIAS DE LA EDUCACI√ìN
const flowUdu = addKeyword(['1', 'edu'])
    .addAnswer([
        '‚úÖ La Licenciatura en Ciencias de la Educaci√≥n es una carrera universitaria que se enfoca en la formaci√≥n de profesionales capacitados para analizar, planificar, desarrollar y evaluar proyectos educativos en diferentes niveles y modalidades del sistema educativo.\n',


        '‚úÖ _La carrera busca formar profesionales con una visi√≥n cr√≠tica y reflexiva de la educaci√≥n, capaces de dise√±ar planes y programas de estudio y aplicar estrategias de ense√±anza y aprendizaje efectivas. Tambi√©n se enfoca en el an√°lisis de las pol√≠ticas educativas y la evaluaci√≥n de los resultados de los proyectos educativos._\n',
        '‚úÖ Los graduados de la Licenciatura en Ciencias de la Educaci√≥n pueden desempe√±arse en diferentes √°mbitos, como la docencia, la gesti√≥n y planificaci√≥n de pol√≠ticas educativas, la investigaci√≥n educativa y la formaci√≥n de docentes. Adem√°s, pueden especializarse en √°reas espec√≠ficas de la educaci√≥n, como la educaci√≥n especial, la educaci√≥n superior o la educaci√≥n para adultos.',

    ],
        {
            media: 'https://i.ibb.co/YXqncWj/PERFIL-EDU.png',
        }
    )
    .addAnswer('‚úÖ La duraci√≥n de la *Carrera a nivel Licenciatura* es de 9 Semestres', {
        delay: 3000,
    })
    .addAnswer(
        [
            '‚úÖ *Modalidades de Admisi√≥n mediante Evaluaci√≥n Previa:*\n',
            "üîπ *La Prueba de Suficiencia Acad√©mica (PSA)*, es la modalidad de ingreso planificada con la oferta de plazas distribuidas para carreras impartidas en la U.A.G.R.M., que consiste la evaluaci√≥n, equivalente al 100% de la nota final.\n",
            "üîπ *Curso Pre-universitario (CUP)*, es la modalidad que consiste en un curso m√≠nimo de 192 horas, presencial o virtual, de preparaci√≥n de bachilleres para el ingreso a la carrera respectiva, constituida por aplicaci√≥n de hasta dos pruebas parciales y culminar√° con una evaluaci√≥n final.",
        ],
        {
            delay: 3000,
        }
    )
    .addAnswer(
        '_*¬ø* Quieres conocer informaci√≥n sobre las *asignaturas* que se imparten actualmente en la carrera de Ciencias de la Educaci√≥n *?*_',
        {
            buttons: [
                { 'body': "Si" },
                { 'body': "‚Ü© volver al menu principal" }
            ],
        },
        null,
        [flowSiEdu,flowVolver],
    )




//SI ESCOGE CIENCIAS DE LA COMUNICACI√ìN
const flowCom = addKeyword(["2", "com"])
    .addAnswer(
        [
            "‚úÖ La carrera de *Ciencias de la Comunicaci√≥n* es una disciplina que estudia la comunicaci√≥n en sus diversas formas y aplicaciones, desde el punto de vista te√≥rico y pr√°ctico. Esta carrera se enfoca en la producci√≥n, difusi√≥n y recepci√≥n de mensajes y en c√≥mo √©stos influyen en las relaciones sociales, pol√≠ticas y culturales.\n",
            "‚úÖ _Al graduarse üë®‚Äçüéì de la carrera de Ciencias de la Comunicaci√≥n, los estudiantes pueden trabajar en diferentes √°mbitos, como el periodismo, la publicidad, las relaciones p√∫blicas, la producci√≥n audiovisual, la investigaci√≥n de mercado y la comunicaci√≥n institucional, entre otros._",
        ],

        {
            media: "https://i.ibb.co/BZnb4fM/PERFIL-COM.png",
        }
    )
    .addAnswer(
        "‚úÖ La duraci√≥n de la *Carrera a nivel Licenciatura* es de 9 Semestres",
        {
            delay: 3000,
        }
    )
    .addAnswer(
        [
            '‚úÖ *Modalidades de Admisi√≥n mediante Evaluaci√≥n Previa:*\n',
            "üîπ *La Prueba de Suficiencia Acad√©mica (PSA)*, es la modalidad de ingreso planificada con la oferta de plazas distribuidas para carreras impartidas en la U.A.G.R.M., que consiste la evaluaci√≥n, equivalente al 100% de la nota final.\n",
            "üîπ *Curso Pre-universitario (CUP)*, es la modalidad que consiste en un curso m√≠nimo de 192 horas, presencial o virtual, de preparaci√≥n de bachilleres para el ingreso a la carrera respectiva, constituida por aplicaci√≥n de hasta dos pruebas parciales y culminar√° con una evaluaci√≥n final.",
        ],
        {
            delay: 3000,
        }
    )
    .addAnswer(
        '_*¬ø* Quieres conocer informaci√≥n sobre las *asignaturas* que se imparten actualmente en la carrera de Ciencias de la Educaci√≥n *?*_',
        {
            buttons: [
                { 'body': "Si" },
                { 'body': "‚Ü© volver al menu principal" }
                    ],
        },
        null,
        [flowSiCom,flowVolver],
    )
    
//SI ESCOGE ADMINISTRACI√ìN EDUCATIVA
const flowAdmin = addKeyword(['3', 'admin'])
    .addAnswer([
        '‚úÖ Licenciatura en *Administraci√≥n Educativa* es un programa ofertado √∫nicamente a profesores normalistas titulados, con duraci√≥n de 4 semestres. La modalidad de ingreso es *directo*, a la presentaci√≥n de documentos *(no requiere examen de ingreso PSA ni CUP)*',
    ],
        {
            media: 'https://i.ibb.co/x1nWGsV/PERFIL-ADMIN-EDU.png',
        }
    )
    .addAnswer([
        '‚úÖ Puede presentar su postulaci√≥n enviando su carpeta a la direcci√≥n que indica el afiche. Sin embargo, para la asignaci√≥n de registro universitario deber√° presentarse de forma presencial en la fecha que se le indicar√°.',
        '*UNA VEZ ASIGNADO EL N√öMERO DE REGISTRO* deber√° realizar los siguientes pagos:¬†',
        'üîπ *8¬∞* An√°lisis cl√≠nicos obtenidos de la U.A.G.R.M. Los an√°lisis son los siguientes: V.S.G. Grupo sangu√≠neo V.D.R.L., Baciloscopia ‚Äì Chagas (pagar Bs 120 en caja Facultad Cs . de la salud Humana - M√≥dulos Universitarios)',
        'üîπ *9¬∞* Fotocopia de revisi√≥n m√©dica. (pagar Bs. 80 en caja Facultad Cs . de la salud Humana - M√≥dulos Universitarios)',
        'üîπ *10¬∞* Aporte al Club Universidad (pagar Bs. 20 en entidades financieras autorizadas)',
        'üîπ *11¬∞* Recibo de pago por fotograf√≠a 3x4 fondo celeste (pagar Bs 12 en entidades financieras autorizadas)¬†',
        'üîπ *12¬∞* Ficha de actualizaci√≥n de datos personales (Bs 75 pago en entidades financieras autorizadas)',
        'üîπ *13¬∞* Pago de ficha de actualizaci√≥n de datos personales (Caja campus Bs 75), adjuntar boleta original',
        'üîπ *14¬∞* Habilitar el servicio desde su perfil de estudiante, la opci√≥n pago de matr√≠cula',
        'üîπ *15¬∞* Cancelar 320 bs. (matr√≠cula semestral a profesionales) en las entidades financieras autorizadas',
    ],
        {
            media: 'https://i.ibb.co/pxYj72f/145-B.jpg',
        }
    )
    .addAnswer(
        '_*¬ø* Quieres conocer informaci√≥n sobre las *asignaturas* que se imparten actualmente en la carrera de Ciencias de la Educaci√≥n *?*_',
        {
            buttons: [
                { 'body': "Si" },
                { 'body': "‚Ü© volver al menu principal" }
        ],
        },
        null,
        [flowSiAdm,flowVolver]
    );




//respuesta a carreras FLOW carreras oferta
const flowCarreras = addKeyword(['aferta', 'afertas', 'carrera', 'Carreras'])
    .addAnswer([
        '_Unidad a Distancia de la Facultad de Humanidades, Universidad Aut√≥noma Gabriel Ren√© Moreno, ofrece los siguientes programas:_',
        '\n*1- Licenciatura en Ciencias de la Educaci√≥n* (9 semestres).',
        '*2- Licenciatura en Ciencias de la Comunicaci√≥n* (9 semestres).',
        '*3- Licenciatura en Administraci√≥n Educativa* (4 semestres)',
        'es un programa ofertado √∫nicamente a *Profesores normalistas titulados.*\n',
        '_¬øCu√°l de nuestros programas de licenciatura es de su inter√©s?_',
        '\n_Por favor *Escribe* el_ *N√∫mero* _de la opci√≥n que deseas consultar_',
        '*Escribe* el numero *0* para volver al Men√∫ principal',
    ],
        null,
        null,
        [flowUdu, flowCom, flowAdmin,flowVolver])
        
    

//respuesta a ubicaci√≥n
const flowUbicacion = addKeyword(['Ubicacion', 'uvicacion', 'Ubicaci√≥n', 'Uvicaci√≥n']).addAnswer([
    '*Unidad a Distancia de la Facultad de Humanidades*',
    '*Atenci√≥n de lunes a viernes*',
    'en Horarios de Oficina de:',
    '*8:00 a 12:00* y *15:00 a 18:30*',
    'Clic para ver la Ubicaci√≥n üìçüëá',
    'https://goo.gl/maps/9FNPtAhvWGdD1HSJ8',
],
    {
        media: 'https://i.ibb.co/0cxkx6w/Sin-t-tulo.png',
    })

// FAQ 
const flowFAQ = addKeyword(['FAQ', 'faq', 'preguntas', 'Preguntas']).addAnswer(
    [
        '*¬°Hola!. Estoy aqu√≠ para ayudarte a responder algunas preguntas y tramites frecuentes de los estudiantes.*\n',
        '*1-* ¬øC√≥mo ingreso al perfil de estudiante?',
        '*2-* Olvid√© mi contrase√±a para acceder a mi perfil web ¬øQu√© debo hacer?',
        '*3-* Mi correo electr√≥nico no est√° registrado ¬øC√≥mo lo puedo registrar?',
        '*4-* Tengo registrado un correo electr√≥nico que ya no utilizo ¬øC√≥mo actualizo mi correo electr√≥nico?',
        '*5-* Cuales son las entidades Entidades financieras autorizas?',
        '*6-* No me acuerdo mi numero de *Registro Universitario* (numero de registro)',
        '*7-* ¬øC√≥mo puedo DESBLOQUEAR mi Registro?',
        'üëâ *TRAMITES Y REGISTROS* üëà\n',
        '*8-* Correcci√≥n de nombre y/o C.I.',
        '*9-* ¬øC√≥mo puedo realizar la READMISI√ìN?',
        '*10-* Certificado de vencimiento de plan de estudios',
        '*11-* Cambio de carrera interfacultad',
        '*12-* Cambio de Carrera dentro de la misma facultad',
        '*13-* Carrera paralela',
        '*14-* Cambio de plan',
        '*15-* Inscripci√≥n de la Modalidad de Titulaci√≥n (GRL)',
        '\n',
        'Por favor *Escribe* el *N√∫mero* de la opci√≥n que deseas consultar',
        '*Escribe* el numero *0* para volver al Men√∫ principal',
        '*Estas Opciones aun no est√°n disponibles*',
    ],
    null,
    null,
    [flowFAQ1, flowFAQ2, flowFAQ3,flowFAQ4, flowFAQ5, flowFAQ6, flowFAQ7,flowFAQ8,flowVolver]
)
//  flowFAQ9, flowFAQ10, flowFAQ11, flowFAQ12, flowFAQ13, flowFAQ14, flowFAQ15, flowFAQ16, flowFAQ17

//respuesta principal
const flowPrincipal = addKeyword(['buenas tardes', 'menu principal', 'buenos dias', 'hola', 'ole', 'alo', 'hola', 'ola', 'info', 'informaci√≥n', 'informacion', '‚Ü© volver al menu principal',])
    .addAnswer('*Hola*,ü§ñ soy el Asistente Virtual de la *Unidad a Distancia de la Facultad de Humanidades*, tengo varias opciones para ayudarte',
    )
    .addAnswer('La modalidad a *Distancia* consiste en un *Sistema H√≠brido*, es decir, rige su avance por tutor√≠as presenciales y virtuales programadas en d√≠as domingo.',
        'Si un estudiante est√° ubicado en otro departamento y no puede asistir a las tutor√≠as presencial, debe presentar una constancia de residencia para acceder a las opciones virtuales. Esto significa que el estudiante puede continuar su educaci√≥n virtual y recibir la misma calidad de educaci√≥n que los estudiantes que asisten a las tutor√≠as presenciales.',
        {
            delay: 3000,
        })
    .addAnswer('_Elige una de las siguientes opciones: üëá_',
        {
            buttons: [
                { "body": "Carreras ofertas", },
                { "body": "Nuestra ubicaci√≥n üìç" },
                { "body": "Preguntas frecuentes FAQ" },
            ],
            delay: 1000,
        },
    )
    .addAnswer('_Cualquier duda que tengas, Presionaüëá_',
        {
            buttons: [
                { "body": "Contactar con una persona üôç‚Äç‚ôÇÔ∏è" },
            ],
            delay: 1000,
        })

//respuesta a gracias
const flowGracias = addKeyword(['Gracias', 'grasias', 'grasia', 'Gracia', 'crasias']).addAnswer([
    'de Nadaüëç',
])

//crear bot con los adaptadores
const main = async () => {
    const adapterDB = new MockAdapter()
    const adapterFlow = createFlow([flowPrincipal, flowCarreras, flowUbicacion, flowGracias, flowFAQ, flowContacto])
    const adapterProvider = createProvider(BaileysProvider)
    createBot({
        flow: adapterFlow,
        provider: adapterProvider,
        database: adapterDB,
    })
    QRPortalWeb()
}
main()